### 实现高可用的相关技术：

#### 持久化：

持久化是最简单的高可用方法(有时甚至不被归为高可用的手段)，主要作用是数据备份，即将数据存储在硬盘，保证数据不会因进程退出而丢失。

#### **主从复制：**

主从复制是高可用 Redis 的基础，哨兵和集群都是在复制基础上实现高可用的。

#### **哨兵：**

在复制的基础上，哨兵实现了自动化的故障恢复。缺陷：写操作无法负载均衡；存储能力受到单机的限制。

#### **集群：**

通过集群，Redis 解决了写操作无法负载均衡，以及存储能力受到单机限制的问题，实现了较为完善的高可用方案。

### 哨兵的功能（4点）：

#### **监控（Monitoring）：**

哨兵会不断地检查主节点和从节点是否运作正常。

#### **自动故障转移（Automatic failover）：**

当主节点不能正常工作时，哨兵会开始自动故障转移操作，它会将失效主节点的其中一个从节点升级为新的主节点，并让其他从节点改为复制新的主节点。

#### **配置提供者（Configurationprovider）：**

客户端在初始化时，通过连接哨兵来获得当前 Redis 服务的主节点地址。

#### **通知（Notification）：**

哨兵可以将故障转移的结果发送给客户端。

其中，监控和自动故障转移功能，使得哨兵可以及时发现主节点故障并完成转移；而配置提供者和通知功能，则需要在与客户端的交互中才能体现。

### 主观下线和客观下线：

默认情况下，每个 Sentinel 节点会以 每秒一次 的频率对 Redis 节点和 其它 的 Sentinel 节点发送 PING 命令，并通过节点的 回复 来判断节点是否在线。 

#### **主观下线：**

主观下线 适用于所有 主节点 和 从节点。如果在 down-after-milliseconds 毫秒内（规定时间内），Sentinel 没有收到 目标节点 的有效回复，则会判定 该节点 为 主观下线。 

#### 客观下线：

客观下线 只适用于 主节点。如果 主节点 出现故障，Sentinel 节点会通过 sentinel is-master-down-by-addr 命令，向其它 Sentinel 节点询问对该节点的 状态判断。如果超过 <quorum> 个数的节点判定 主节点 不可达，则该 Sentinel 节点会判断 主节点 为 客观下线。

 

